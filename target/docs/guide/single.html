<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>Metridoc Core Plugin 0.52-SNAPSHOT</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <script type="text/javascript">
function addJsClass(el) {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
    </head>

    <body class="body" onload="addJsClass();">
        <div id="navigation">
            <ul>
                <li>
                    <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                        <a href="../guide/index.html" class="button">Table of contents</a>
                        <div id="nav-summary-childs" style="display:none;">
                            
                            <div class="toc-item" style="margin-left:0"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#gettingStarted"><strong>2</strong><span>Getting Started</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#configuration"><strong>3</strong><span>Configuration</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#metridocJobApi"><strong>4</strong><span>Job Api</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#metridocPlugins"><strong>5</strong><span>Metridoc Plugins</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#metridocSecurity"><strong>6</strong><span>Metridoc Security</span></a></div>
                            
                        </div>
                    </div>
                </li>
                <li class="separator selected">
                    <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
                </li>
            </ul>
        </div>
        <div id="header">
            <div class="images clearfix">
                
                
            </div>
            <p>
    Provides core functionality for metridoc and all related plugins
</p>
        </div>


        <table id="colset" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td id="col1">
                    <div id="main" class="corner-all">

                        <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                        <div class="project">
                            <h1>Metridoc Core Plugin - Reference Documentation</h1>
                            <p><strong>Authors:</strong> Thomas Barker</p>
                            <p><strong>Version:</strong> 0.52-SNAPSHOT</p>
                            
                        </div>

                        
                        <div id="table-of-content">
                            <h2>Table of Contents</h2>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#gettingStarted"><strong>2</strong><span>Getting Started</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#requiredSoftware"><strong>2.1</strong><span>Required Software</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#requiredExperience"><strong>2.2</strong><span>Required Experience</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#firstMetridocProject"><strong>2.3</strong><span>First MetriDoc Project</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#developingMetridoc"><strong>2.4</strong><span>Developing MetriDoc</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#upgradingMetridoc"><strong>2.5</strong><span>Upgrading MetriDoc</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#configuration"><strong>3</strong><span>Configuration</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#metridocJobApi"><strong>4</strong><span>Job Api</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#metridocPlugins"><strong>5</strong><span>Metridoc Plugins</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#availablePlugins"><strong>5.1</strong><span>Available Plugins</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#overridingPluginArtifacts"><strong>5.2</strong><span>Overriding Plugin Artifacts</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#writingYourOwnPlugin"><strong>5.3</strong><span>Writing Your Own Plugin</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#creatingJobs"><strong>5.4</strong><span>Creating and running jobs</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#metridocSecurity"><strong>6</strong><span>Metridoc Security</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#securityBasics"><strong>6.1</strong><span>Security Basics</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#securityConfiguration"><strong>6.2</strong><span>Security Configuration</span></a></div>
                            
                            <div style="clear:both" ></div>
                        </div>
                        
                        

<h1 id="introduction">1 Introduction</h1>
MetriDoc is an extendable platform to view and maintain library statistics and reports.
The platform is based on the web framework <a href="http://www.grails.org" target="blank">Grails</a> which provides
a simple web framework as well as a scripting engine that is well suited for various
jobs that need to to be run in MetriDoc to transport data from internal systems to
a central repository.  Problem spaces are split into <a href="http://www.grails.org" target="blank">Grails</a> plugins
to enhance the user experience as well as encourage community plugins.


<h1 id="gettingStarted">2 Getting Started</h1>



<h2 id="requiredSoftware">2.1 Required Software</h2>
<ul class="star">
<li><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="blank">Java 6 or above</a></li>
<li><a href="http://dist.springframework.org.s3.amazonaws.com/release/GRAILS/grails-2.0.4.zip" target="blank">Grails 2.1.1</a> (optional, see below)</li>
<li><a href="http://www.mysql.com/" target="blank">Mysql</a></li>
<li>Subversion</li>
<li>Text editor or IDE (IntelliJ, Eclipse or NetBeans)</li>
</ul><p class="paragraph"/>Grails is optional.  Every project we build uses the <a href="http://grails.org/doc/latest/guide/commandLine.html#wrapper" target="blank">grails wrapper</a>.
So for instance, if you are on a linux based system, simply run <code>./grailsw</code> instead of grails at the top of the project.
This allows you to use grails with only the jvm installed!  Another option is to use <a href="http://fbflex.wordpress.com/2012/10/04/managing-multiple-versions-of-grails-with-gvm/" target="blank">gvm</a>
 (Groovy enVironment Manager).  We actually use this in our startup script for creating a base MetriDoc project.<p class="paragraph"/>At some point it is likely that MetriDoc will use 100% GORM for object relational mapping.  At this point most any
database supported by this library could be used.<p class="paragraph"/>Many package managers have grails.  For instance, if you are using a mac, try <a href="http://www.macports.org/" target="blank">MacPorts</a>
and do <code>sudo port install grails</code>.  For Ubuntu you can follow the instructions on the bottom of the Grails download
<a href="http://grails.org/Download/" target="blank">page</a><p class="paragraph"/>MetriDoc is developed in IntelliJ, and to a lesser extent Eclipse and vim.  Although IntelliJ is not free, it
is a very good IDE for Grails.  Education licenses for IntelliJ are very cheap.  You can find details for setting up
Grails in various IDE / Text editor environments <a href="http://grails.org/doc/latest/guide/gettingStarted.html#ide" target="blank">here</a>



<h2 id="requiredExperience">2.2 Required Experience</h2>
MetriDoc uses the web framework <a href="http://www.grails.org" target="blank">Grails</a>.  Grails is similar to the web framework ruby on rails framework,
but sits on top of the Groovy language.  Anyone with Java web experience, or experience in rapid development
environments such as Rails or Django should pick up Grails quickly.<p class="paragraph"/>Here are some Grails resources:
<ul class="star">
<li><a href="http://www.grails.org" target="blank">Grails Website</a></li>
<li><a href="http://grails.org/doc/latest/" target="blank">Grails User Manual</a></li>
<li><a href="http://grails.org/Tutorials" target="blank">Tutorials</a></li>
<li><a href="http://www.manning.com/gsmith/" target="blank">Grails in Action</a></li>
</ul><p class="paragraph"/>


<h2 id="firstMetridocProject">2.3 First MetriDoc Project</h2>
We used to have a starter project available, but as we have continued to streamline MetriDoc, this really didn't seem
worth the effort anymore.  Using the standard grails create-app method gets you started just fine<p class="paragraph"/><h3>Installing via Commandline</h3><p class="paragraph"/><div class="code"><pre>curl &#45;s https://metridoc.googlecode.com/svn/trunk/startup/createMetridocProject.sh | sh
cd metridoc
grails run&#45;app</pre></div><p class="paragraph"/>The script above installs the gvm if it is not already installed, along with grails.  You just need java.  The gvm
does inspect your environment and may require you to set various path variables such as JAVA_HOME<p class="paragraph"/>If all goes well, you should see this page:<p class="paragraph"/><img border="0" class="center" src="http://metridoc.googlecode.com/svn/trunk/metridoc-core/src/docs/images/MetriDocHome.png"></img><p class="paragraph"/><h3>Installing Manually</h3><p class="paragraph"/>After installing grails via the methods mentioned <a href="http://metridoc.googlecode.com/svn/trunk/metridoc-core/target/docs/guide/gettingStarted.html#requiredSoftware" target="blank">here</a>,
run <code>grails create-app metridoc</code> on the command line.  After this is done you will need to change a few files and delete the contents
of a directory to get metridoc core up and running.<p class="paragraph"/>Below is a table of files that need to be replaced:<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">Local File</strong></th><th><strong class="bold">Replace With</strong></th></tr><tr class="table-odd"><td>metridoc/grails-app/conf/BuildConfig.groovy</td><td><a href="http://metridoc.googlecode.com/svn/trunk/startup/BuildConfig.groovy" target="blank">BuildConfig.groovy</a></td></tr><tr class="table-even"><td>metridoc/grails-app/conf/Config.groovy</td><td><a href="http://metridoc.googlecode.com/svn/trunk/metridoc-core/grails-app/conf/Config.groovy" target="blank">Config.groovy</a></td></tr><tr class="table-odd"><td>metridoc/grails-app/conf/UrlMappings.groovy</td><td><a href="http://metridoc.googlecode.com/svn/trunk/metridoc-core/grails-app/conf/UrlMappings.groovy" target="blank">UrlMappings</a></td></tr></table><p class="paragraph"/>After the files have been updated, delete the contents of the directory grails-app/views
and navigate to the metridoc directory and run <code>grails run-app</code><p class="paragraph"/>If all goes well, you should see this page:<p class="paragraph"/><img border="0" class="center" src="http://metridoc.googlecode.com/svn/trunk/metridoc-core/src/docs/images/MetriDocHome.png"></img><p class="paragraph"/><blockquote class="note">
The plugin may fail saying that there is a corrupt cache.  If this happens, run
<code>grails --refresh-dependencies compile</code> and try <code>grails run-app</code> again
</blockquote>


<h2 id="developingMetridoc">2.4 Developing MetriDoc</h2>
If you are developing metridoc you will need to checkout MetriDoc trunk using subversion by running the command:<p class="paragraph"/><div class="code"><pre>svn co https://metridoc.googlecode.com/svn/trunk</pre></div><p class="paragraph"/>Many IDEs have version control support.  If you are using IntelliJ you can do <code>VCS -&#62; Checkout from Version Control -&#62; Subversion</code>.
Add the repository https://metridoc.googlecode.com/svn/trunk and follow the instructions.  By doing this, IntelliJ
will create a project structure for all the metridoc modules


<h2 id="upgradingMetridoc">2.5 Upgrading MetriDoc</h2>
Upgrading is simple.  Just go into your BuildConfig.groovy file and change the version of metridoc that you are using.
For instance, say you see something like
<div class="code"><pre>compile (&#34;:metridoc&#45;core:0.52&#45;SNAPSHOT&#34;) &#123;
    exclude <span class="java&#45;quote">"shiro&#45;quartz"</span>
&#125;</pre></div>
in your <code>BuildConfig.groovy</code>.  You can change to version <code>0.52</code> by just replacing <code>0.52-SNAPSHOT</code> with <code>0.52</code>


<h1 id="configuration">3 Configuration</h1>
<h3> Setting up the DataSource</h3><p class="paragraph"/>To setup data sources, edit the DataSources.groovy file located at grails-app/conf/DataSources.groovy.  At bare
minimum you will need a user name, password, database url and driver class name.  In general it is recommended that
you use MySql, going forward MetriDoc plugins will abstract database operations as much as possible so any database
supported by GORM can be used.  To the extent a plugin requires MySql, the documentation will indicate this.<p class="paragraph"/><h3> Downloading Config.groovy, BuildConfig.groovy, and UrlMappings.groovy</h3><p class="paragraph"/>If you created a project from the <a href="../guide/single.html#firstMetridocProject" class="guide">Getting Started</a> section, this is already
done for you.  If not please follow the instructions there or if you have access to bash, just run<p class="paragraph"/><div class="code"><pre>curl &#45;s http://metridoc.googlecode.com/svn/trunk/startup/createConfigFiles.sh | sh</pre></div><p class="paragraph"/>You must be within the project for the curl call to work<p class="paragraph"/>


<h1 id="metridocJobApi">4 Job Api</h1>
The metridoc job api is essentially a collection of existing technologies.  It tries to merge the simplicity of
scripting and the maintainability of java.  Writing data migration jobs in java is overkill, and using one off
scripts tends to lead to maintainability issues.  MetriDoc attempts to combine the best of both worlds by leveraging
groovy and grails.<p class="paragraph"/>A job can either be embedded and scheduled in a grails application, or it can be run via the command line and scheduled
through some other mechanism such as cron.  To create a job, first run <code>grails create-plugin &#60;plugin name&#62;</code>.
To add the metridoc libraries we need to add a couple lines to the BuildConfig.groovy file.  In the repositories section
put:<p class="paragraph"/><div class="code"><pre>repositories &#123;
    &#8230;
    grailsRepo <span class="java&#45;quote">"https://metridoc.googlecode.com/svn/plugins/"</span>
&#125;</pre></div><p class="paragraph"/>In the plugins section put:<p class="paragraph"/><div class="code"><pre>plugins &#123;
    compile(&#34;:metridoc&#45;core:0.52&#45;SNAPSHOT&#34;)
&#125;</pre></div><p class="paragraph"/>After adding the necessary information to the BuildConfig.groovy file, run <code>grails compile</code> to download all the metridoc
libraries.<p class="paragraph"/>Grails creates a lot of files and folders to create a full blown web application.  If you just need to create a job
without a web application, you can run <code>grails configure-for-job-only</code>.  The script will remove all unnecessary files
and folders in addition to prompting for a job name.  After running the script, you will have an infrastructure to
create metridoc jobs without the clutter.<p class="paragraph"/>


<h1 id="metridocPlugins">5 Metridoc Plugins</h1>
MetriDoc is a collection of grails plugins that you can install depending on your needs.  To see what plugins
are available, simply run<p class="paragraph"/><div class="code"><pre>grails list&#45;plugins &#45;repository=metridocRepo</pre></div><p class="paragraph"/><blockquote class="note">
This assumes that you are using the starter project, otherwise you need to reference the code repository in your
BuildConfig.groovy file with the line
<div class="code"><pre>grailsRepo <span class="java&#45;quote">"https://metridoc.googlecode.com/svn/plugins/"</span>, <span class="java&#45;quote">"metridocRepo"</span></pre></div>
Please see <a href="http://metridoc.googlecode.com/svn/trunk/startup/metridoc/grails-app/conf/BuildConfig.groovy" target="blank">BuildConfig</a> for an example
</blockquote>


<h2 id="availablePlugins">5.1 Available Plugins</h2>
<ul class="star">
<li><a href="http://metridoc.googlecode.com/svn/trunk/metridoc-illiad/target/docs/index.html" target="blank">Illiad</a></li>
</ul><p class="paragraph"/>


<h2 id="overridingPluginArtifacts">5.2 Overriding Plugin Artifacts</h2>



<h2 id="writingYourOwnPlugin">5.3 Writing Your Own Plugin</h2>



<h2 id="creatingJobs">5.4 Creating and running jobs</h2>



<h1 id="metridocSecurity">6 Metridoc Security</h1>
Metridoc uses <a href="http://shiro.apache.org/" target="blank">Apache Shiro</a> for security.  Currently it is backed by a database, but future
versions of Metridoc will allow users to hook in their own security.  Out of the box, basic dashboards to manage users
and roles exist, as well as assigning roles to reports.


<h2 id="securityBasics">6.1 Security Basics</h2>



<h2 id="securityConfiguration">6.2 Security Configuration</h2>


                    </div>
                </td>
                <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">commandline</h1><div class="menu-sub">
                        
                        
                        <div class="menu-item"><a href="../ref/commandline/configure-for-job-only.html">configure-for-job-only</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/commandline/flush-cache.html">flush-cache</a>
                        </div>
                        
                        </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">taglibs</h1><div class="menu-sub">
                        
                        
                        </div>
                    </div>
                    
                </div>
            </div>
        </td>
            </tr>
        </table>

        <div id="footer">
            
            
        </div>



<script type="text/javascript" src="../js/docs.js"></script>

    </body>
</html>
